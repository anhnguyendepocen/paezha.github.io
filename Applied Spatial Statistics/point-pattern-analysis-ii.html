<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Practical Data Analysis for the Spatial Sciences in R</title>
  <meta name="description" content="This is my first attempt to create a book using bookdown.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Practical Data Analysis for the Spatial Sciences in R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is my first attempt to create a book using bookdown." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Practical Data Analysis for the Spatial Sciences in R" />
  
  <meta name="twitter:description" content="This is my first attempt to create a book using bookdown." />
  

<meta name="author" content="Antonio Paez">


<meta name="date" content="2018-05-07">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="point-pattern-analysis-i-activity.html">
<link rel="next" href="point-pattern-analysis-ii-activity.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.2/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.7.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotlyjs-1.29.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotlyjs-1.29.2/plotly-latest.min.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>1</b> Introduction to R</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#learning-objectives"><i class="fa fa-check"></i><b>1.1</b> Learning objectives</a></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#rstudio-window"><i class="fa fa-check"></i><b>1.2</b> RStudio Window</a></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#some-basic-operations"><i class="fa fa-check"></i><b>1.3</b> Some basic operations</a></li>
<li class="chapter" data-level="1.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-classes-in-r"><i class="fa fa-check"></i><b>1.4</b> Data Classes in R</a></li>
<li class="chapter" data-level="1.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-types-in-r"><i class="fa fa-check"></i><b>1.5</b> Data Types in R</a></li>
<li class="chapter" data-level="1.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#indexing-and-data-transformations"><i class="fa fa-check"></i><b>1.6</b> Indexing and Data Transformations</a></li>
<li class="chapter" data-level="1.7" data-path="introduction-to-r.html"><a href="introduction-to-r.html#visualization"><i class="fa fa-check"></i><b>1.7</b> Visualization</a></li>
<li class="chapter" data-level="1.8" data-path="introduction-to-r.html"><a href="introduction-to-r.html#creating-a-simple-map"><i class="fa fa-check"></i><b>1.8</b> Creating a simple map</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-mapping-in-r.html"><a href="introduction-to-mapping-in-r.html"><i class="fa fa-check"></i><b>2</b> Introduction to Mapping in R</a><ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-mapping-in-r.html"><a href="introduction-to-mapping-in-r.html#learning-objectives-1"><i class="fa fa-check"></i><b>2.1</b> Learning objectives</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-mapping-in-r.html"><a href="introduction-to-mapping-in-r.html#preliminaries"><i class="fa fa-check"></i><b>2.2</b> Preliminaries</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-mapping-in-r.html"><a href="introduction-to-mapping-in-r.html#improving-on-the-proportional-symbols-map"><i class="fa fa-check"></i><b>2.3</b> Improving on the proportional symbols map</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introduction-to-mapping-in-r-activity.html"><a href="introduction-to-mapping-in-r-activity.html"><i class="fa fa-check"></i><b>3</b> Introduction to Mapping in R - Activity</a><ul>
<li class="chapter" data-level="3.1" data-path="introduction-to-mapping-in-r-activity.html"><a href="introduction-to-mapping-in-r-activity.html#preliminaries-1"><i class="fa fa-check"></i><b>3.1</b> Preliminaries</a></li>
<li class="chapter" data-level="3.2" data-path="introduction-to-mapping-in-r-activity.html"><a href="introduction-to-mapping-in-r-activity.html#activity"><i class="fa fa-check"></i><b>3.2</b> Activity</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="statistical-maps-ii.html"><a href="statistical-maps-ii.html"><i class="fa fa-check"></i><b>4</b> Statistical Maps II</a><ul>
<li class="chapter" data-level="4.1" data-path="statistical-maps-ii.html"><a href="statistical-maps-ii.html#learning-objectives-2"><i class="fa fa-check"></i><b>4.1</b> Learning objectives</a></li>
<li class="chapter" data-level="4.2" data-path="statistical-maps-ii.html"><a href="statistical-maps-ii.html#suggested-reading"><i class="fa fa-check"></i><b>4.2</b> Suggested reading</a></li>
<li class="chapter" data-level="4.3" data-path="statistical-maps-ii.html"><a href="statistical-maps-ii.html#preliminaries-2"><i class="fa fa-check"></i><b>4.3</b> Preliminaries</a></li>
<li class="chapter" data-level="4.4" data-path="statistical-maps-ii.html"><a href="statistical-maps-ii.html#summarizing-a-dataframe"><i class="fa fa-check"></i><b>4.4</b> Summarizing a dataframe</a></li>
<li class="chapter" data-level="4.5" data-path="statistical-maps-ii.html"><a href="statistical-maps-ii.html#factors"><i class="fa fa-check"></i><b>4.5</b> Factors</a></li>
<li class="chapter" data-level="4.6" data-path="statistical-maps-ii.html"><a href="statistical-maps-ii.html#subsetting-data"><i class="fa fa-check"></i><b>4.6</b> Subsetting data</a></li>
<li class="chapter" data-level="4.7" data-path="statistical-maps-ii.html"><a href="statistical-maps-ii.html#pipe-operator"><i class="fa fa-check"></i><b>4.7</b> Pipe operator</a></li>
<li class="chapter" data-level="4.8" data-path="statistical-maps-ii.html"><a href="statistical-maps-ii.html#more-on-mapping"><i class="fa fa-check"></i><b>4.8</b> More on mapping</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="statistical-maps-ii-activity.html"><a href="statistical-maps-ii-activity.html"><i class="fa fa-check"></i><b>5</b> Statistical Maps II - Activity</a><ul>
<li class="chapter" data-level="5.1" data-path="statistical-maps-ii-activity.html"><a href="statistical-maps-ii-activity.html#housekeeping-questions"><i class="fa fa-check"></i><b>5.1</b> Housekeeping Questions</a></li>
<li class="chapter" data-level="5.2" data-path="statistical-maps-ii-activity.html"><a href="statistical-maps-ii-activity.html#learning-objectives-3"><i class="fa fa-check"></i><b>5.2</b> Learning objectives</a></li>
<li class="chapter" data-level="5.3" data-path="statistical-maps-ii-activity.html"><a href="statistical-maps-ii-activity.html#suggested-reading-1"><i class="fa fa-check"></i><b>5.3</b> Suggested reading</a></li>
<li class="chapter" data-level="5.4" data-path="statistical-maps-ii-activity.html"><a href="statistical-maps-ii-activity.html#preliminaries-3"><i class="fa fa-check"></i><b>5.4</b> Preliminaries</a></li>
<li class="chapter" data-level="5.5" data-path="statistical-maps-ii-activity.html"><a href="statistical-maps-ii-activity.html#activity-1"><i class="fa fa-check"></i><b>5.5</b> Activity</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="maps-as-processes-null-landscapes-and-spatial-processes.html"><a href="maps-as-processes-null-landscapes-and-spatial-processes.html"><i class="fa fa-check"></i><b>6</b> Maps as Processes: Null Landscapes and Spatial Processes</a><ul>
<li class="chapter" data-level="6.1" data-path="maps-as-processes-null-landscapes-and-spatial-processes.html"><a href="maps-as-processes-null-landscapes-and-spatial-processes.html#introduction"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="maps-as-processes-null-landscapes-and-spatial-processes.html"><a href="maps-as-processes-null-landscapes-and-spatial-processes.html#learning-objectives-4"><i class="fa fa-check"></i><b>6.2</b> Learning objectives</a></li>
<li class="chapter" data-level="6.3" data-path="maps-as-processes-null-landscapes-and-spatial-processes.html"><a href="maps-as-processes-null-landscapes-and-spatial-processes.html#suggested-reading-2"><i class="fa fa-check"></i><b>6.3</b> Suggested reading</a></li>
<li class="chapter" data-level="6.4" data-path="maps-as-processes-null-landscapes-and-spatial-processes.html"><a href="maps-as-processes-null-landscapes-and-spatial-processes.html#preliminaries-4"><i class="fa fa-check"></i><b>6.4</b> Preliminaries</a></li>
<li class="chapter" data-level="6.5" data-path="maps-as-processes-null-landscapes-and-spatial-processes.html"><a href="maps-as-processes-null-landscapes-and-spatial-processes.html#random-numbers"><i class="fa fa-check"></i><b>6.5</b> Random numbers</a></li>
<li class="chapter" data-level="6.6" data-path="maps-as-processes-null-landscapes-and-spatial-processes.html"><a href="maps-as-processes-null-landscapes-and-spatial-processes.html#null-landscapes"><i class="fa fa-check"></i><b>6.6</b> Null landscapes</a></li>
<li class="chapter" data-level="6.7" data-path="maps-as-processes-null-landscapes-and-spatial-processes.html"><a href="maps-as-processes-null-landscapes-and-spatial-processes.html#simulating-spatial-processes"><i class="fa fa-check"></i><b>6.7</b> Simulating spatial processes</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="statistical-maps-maps-as-processes-activity.html"><a href="statistical-maps-maps-as-processes-activity.html"><i class="fa fa-check"></i><b>7</b> Statistical Maps: Maps as Processes - Activity</a><ul>
<li class="chapter" data-level="7.1" data-path="statistical-maps-maps-as-processes-activity.html"><a href="statistical-maps-maps-as-processes-activity.html#practice-questions"><i class="fa fa-check"></i><b>7.1</b> Practice questions</a></li>
<li class="chapter" data-level="7.2" data-path="statistical-maps-maps-as-processes-activity.html"><a href="statistical-maps-maps-as-processes-activity.html#learning-objectives-5"><i class="fa fa-check"></i><b>7.2</b> Learning objectives</a></li>
<li class="chapter" data-level="7.3" data-path="statistical-maps-maps-as-processes-activity.html"><a href="statistical-maps-maps-as-processes-activity.html#suggested-reading-3"><i class="fa fa-check"></i><b>7.3</b> Suggested reading</a></li>
<li class="chapter" data-level="7.4" data-path="statistical-maps-maps-as-processes-activity.html"><a href="statistical-maps-maps-as-processes-activity.html#preliminaries-5"><i class="fa fa-check"></i><b>7.4</b> Preliminaries</a></li>
<li class="chapter" data-level="7.5" data-path="statistical-maps-maps-as-processes-activity.html"><a href="statistical-maps-maps-as-processes-activity.html#activity-2"><i class="fa fa-check"></i><b>7.5</b> Activity</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="point-pattern-analysis-i.html"><a href="point-pattern-analysis-i.html"><i class="fa fa-check"></i><b>8</b> Point Pattern Analysis I</a><ul>
<li class="chapter" data-level="8.1" data-path="point-pattern-analysis-i.html"><a href="point-pattern-analysis-i.html#introduction-1"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="point-pattern-analysis-i.html"><a href="point-pattern-analysis-i.html#learning-objectives-6"><i class="fa fa-check"></i><b>8.2</b> Learning objectives</a></li>
<li class="chapter" data-level="8.3" data-path="point-pattern-analysis-i.html"><a href="point-pattern-analysis-i.html#suggested-reading-4"><i class="fa fa-check"></i><b>8.3</b> Suggested reading</a></li>
<li class="chapter" data-level="8.4" data-path="point-pattern-analysis-i.html"><a href="point-pattern-analysis-i.html#preliminaries-6"><i class="fa fa-check"></i><b>8.4</b> Preliminaries</a></li>
<li class="chapter" data-level="8.5" data-path="point-pattern-analysis-i.html"><a href="point-pattern-analysis-i.html#point-patterns"><i class="fa fa-check"></i><b>8.5</b> Point patterns</a></li>
<li class="chapter" data-level="8.6" data-path="point-pattern-analysis-i.html"><a href="point-pattern-analysis-i.html#processes-and-point-patterns"><i class="fa fa-check"></i><b>8.6</b> Processes and point patterns</a></li>
<li class="chapter" data-level="8.7" data-path="point-pattern-analysis-i.html"><a href="point-pattern-analysis-i.html#intensity-and-density"><i class="fa fa-check"></i><b>8.7</b> Intensity and density</a></li>
<li class="chapter" data-level="8.8" data-path="point-pattern-analysis-i.html"><a href="point-pattern-analysis-i.html#quadrats-and-density-maps"><i class="fa fa-check"></i><b>8.8</b> Quadrats and density maps</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="point-pattern-analysis-i-activity.html"><a href="point-pattern-analysis-i-activity.html"><i class="fa fa-check"></i><b>9</b> Point Pattern Analysis I-Activity</a><ul>
<li class="chapter" data-level="9.1" data-path="point-pattern-analysis-i-activity.html"><a href="point-pattern-analysis-i-activity.html#practice-questions-1"><i class="fa fa-check"></i><b>9.1</b> Practice questions</a></li>
<li class="chapter" data-level="9.2" data-path="point-pattern-analysis-i-activity.html"><a href="point-pattern-analysis-i-activity.html#learning-objectives-7"><i class="fa fa-check"></i><b>9.2</b> Learning objectives</a></li>
<li class="chapter" data-level="9.3" data-path="point-pattern-analysis-i-activity.html"><a href="point-pattern-analysis-i-activity.html#suggested-reading-5"><i class="fa fa-check"></i><b>9.3</b> Suggested reading</a></li>
<li class="chapter" data-level="9.4" data-path="point-pattern-analysis-i-activity.html"><a href="point-pattern-analysis-i-activity.html#preliminaries-7"><i class="fa fa-check"></i><b>9.4</b> Preliminaries</a></li>
<li class="chapter" data-level="9.5" data-path="point-pattern-analysis-i-activity.html"><a href="point-pattern-analysis-i-activity.html#activity-3"><i class="fa fa-check"></i><b>9.5</b> Activity</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="point-pattern-analysis-ii.html"><a href="point-pattern-analysis-ii.html"><i class="fa fa-check"></i><b>10</b> Point Pattern Analysis II</a><ul>
<li class="chapter" data-level="10.1" data-path="point-pattern-analysis-ii.html"><a href="point-pattern-analysis-ii.html#introduction-2"><i class="fa fa-check"></i><b>10.1</b> Introduction</a></li>
<li class="chapter" data-level="10.2" data-path="point-pattern-analysis-ii.html"><a href="point-pattern-analysis-ii.html#learning-objectives-8"><i class="fa fa-check"></i><b>10.2</b> Learning objectives</a></li>
<li class="chapter" data-level="10.3" data-path="point-pattern-analysis-ii.html"><a href="point-pattern-analysis-ii.html#suggested-reading-6"><i class="fa fa-check"></i><b>10.3</b> Suggested reading</a></li>
<li class="chapter" data-level="10.4" data-path="point-pattern-analysis-ii.html"><a href="point-pattern-analysis-ii.html#preliminaries-8"><i class="fa fa-check"></i><b>10.4</b> Preliminaries</a></li>
<li class="chapter" data-level="10.5" data-path="point-pattern-analysis-ii.html"><a href="point-pattern-analysis-ii.html#a-quadrat-based-test-for-spatial-independence"><i class="fa fa-check"></i><b>10.5</b> A quadrat-based test for spatial independence</a></li>
<li class="chapter" data-level="10.6" data-path="point-pattern-analysis-ii.html"><a href="point-pattern-analysis-ii.html#limitations-of-quadrat-analysis-size-and-number-of-quadrats"><i class="fa fa-check"></i><b>10.6</b> Limitations of quadrat analysis: size and number of quadrats</a></li>
<li class="chapter" data-level="10.7" data-path="point-pattern-analysis-ii.html"><a href="point-pattern-analysis-ii.html#limitations-of-quadrat-analysis-relative-position-of-events"><i class="fa fa-check"></i><b>10.7</b> Limitations of quadrat analysis: relative position of events</a></li>
<li class="chapter" data-level="10.8" data-path="point-pattern-analysis-ii.html"><a href="point-pattern-analysis-ii.html#kernel-density"><i class="fa fa-check"></i><b>10.8</b> Kernel density</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="point-pattern-analysis-ii-activity.html"><a href="point-pattern-analysis-ii-activity.html"><i class="fa fa-check"></i><b>11</b> Point Pattern Analysis II-Activity</a><ul>
<li class="chapter" data-level="11.1" data-path="point-pattern-analysis-ii-activity.html"><a href="point-pattern-analysis-ii-activity.html#practice-questions-2"><i class="fa fa-check"></i><b>11.1</b> Practice questions</a></li>
<li class="chapter" data-level="11.2" data-path="point-pattern-analysis-ii-activity.html"><a href="point-pattern-analysis-ii-activity.html#learning-objectives-9"><i class="fa fa-check"></i><b>11.2</b> Learning objectives</a></li>
<li class="chapter" data-level="11.3" data-path="point-pattern-analysis-ii-activity.html"><a href="point-pattern-analysis-ii-activity.html#suggested-reading-7"><i class="fa fa-check"></i><b>11.3</b> Suggested reading</a></li>
<li class="chapter" data-level="11.4" data-path="point-pattern-analysis-ii-activity.html"><a href="point-pattern-analysis-ii-activity.html#preliminaries-9"><i class="fa fa-check"></i><b>11.4</b> Preliminaries</a></li>
<li class="chapter" data-level="11.5" data-path="point-pattern-analysis-ii-activity.html"><a href="point-pattern-analysis-ii-activity.html#activity-4"><i class="fa fa-check"></i><b>11.5</b> Activity</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="point-pattern-analysis-iii.html"><a href="point-pattern-analysis-iii.html"><i class="fa fa-check"></i><b>12</b> Point Pattern Analysis III</a><ul>
<li class="chapter" data-level="12.1" data-path="point-pattern-analysis-iii.html"><a href="point-pattern-analysis-iii.html#introduction-3"><i class="fa fa-check"></i><b>12.1</b> Introduction</a></li>
<li class="chapter" data-level="12.2" data-path="point-pattern-analysis-iii.html"><a href="point-pattern-analysis-iii.html#learning-objectives-10"><i class="fa fa-check"></i><b>12.2</b> Learning objectives</a></li>
<li class="chapter" data-level="12.3" data-path="point-pattern-analysis-iii.html"><a href="point-pattern-analysis-iii.html#suggested-reading-8"><i class="fa fa-check"></i><b>12.3</b> Suggested reading</a></li>
<li class="chapter" data-level="12.4" data-path="point-pattern-analysis-iii.html"><a href="point-pattern-analysis-iii.html#preliminaries-10"><i class="fa fa-check"></i><b>12.4</b> Preliminaries</a></li>
<li class="chapter" data-level="12.5" data-path="point-pattern-analysis-iii.html"><a href="point-pattern-analysis-iii.html#motivation"><i class="fa fa-check"></i><b>12.5</b> Motivation</a></li>
<li class="chapter" data-level="12.6" data-path="point-pattern-analysis-iii.html"><a href="point-pattern-analysis-iii.html#nearest-neighbors"><i class="fa fa-check"></i><b>12.6</b> Nearest neighbors</a></li>
<li class="chapter" data-level="12.7" data-path="point-pattern-analysis-iii.html"><a href="point-pattern-analysis-iii.html#g-function"><i class="fa fa-check"></i><b>12.7</b> G-function</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="point-pattern-analysis-iii-activity.html"><a href="point-pattern-analysis-iii-activity.html"><i class="fa fa-check"></i><b>13</b> Point Pattern Analysis III-Activity</a><ul>
<li class="chapter" data-level="13.1" data-path="point-pattern-analysis-iii-activity.html"><a href="point-pattern-analysis-iii-activity.html#practice-questions-3"><i class="fa fa-check"></i><b>13.1</b> Practice questions</a></li>
<li class="chapter" data-level="13.2" data-path="point-pattern-analysis-iii-activity.html"><a href="point-pattern-analysis-iii-activity.html#learning-objectives-11"><i class="fa fa-check"></i><b>13.2</b> Learning objectives</a></li>
<li class="chapter" data-level="13.3" data-path="point-pattern-analysis-iii-activity.html"><a href="point-pattern-analysis-iii-activity.html#suggested-reading-9"><i class="fa fa-check"></i><b>13.3</b> Suggested reading</a></li>
<li class="chapter" data-level="13.4" data-path="point-pattern-analysis-iii-activity.html"><a href="point-pattern-analysis-iii-activity.html#preliminaries-11"><i class="fa fa-check"></i><b>13.4</b> Preliminaries</a></li>
<li class="chapter" data-level="13.5" data-path="point-pattern-analysis-iii-activity.html"><a href="point-pattern-analysis-iii-activity.html#activity-5"><i class="fa fa-check"></i><b>13.5</b> Activity</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="point-pattern-analysis-iv.html"><a href="point-pattern-analysis-iv.html"><i class="fa fa-check"></i><b>14</b> Point Pattern Analysis IV</a><ul>
<li class="chapter" data-level="14.1" data-path="point-pattern-analysis-iv.html"><a href="point-pattern-analysis-iv.html#introduction-4"><i class="fa fa-check"></i><b>14.1</b> Introduction</a></li>
<li class="chapter" data-level="14.2" data-path="point-pattern-analysis-iv.html"><a href="point-pattern-analysis-iv.html#learning-objectives-12"><i class="fa fa-check"></i><b>14.2</b> Learning objectives</a></li>
<li class="chapter" data-level="14.3" data-path="point-pattern-analysis-iv.html"><a href="point-pattern-analysis-iv.html#suggested-reading-10"><i class="fa fa-check"></i><b>14.3</b> Suggested reading</a></li>
<li class="chapter" data-level="14.4" data-path="point-pattern-analysis-iv.html"><a href="point-pattern-analysis-iv.html#preliminaries-12"><i class="fa fa-check"></i><b>14.4</b> Preliminaries</a></li>
<li class="chapter" data-level="14.5" data-path="point-pattern-analysis-iv.html"><a href="point-pattern-analysis-iv.html#motivation-1"><i class="fa fa-check"></i><b>14.5</b> Motivation</a></li>
<li class="chapter" data-level="14.6" data-path="point-pattern-analysis-iv.html"><a href="point-pattern-analysis-iv.html#f-function"><i class="fa fa-check"></i><b>14.6</b> F-function</a></li>
<li class="chapter" data-level="14.7" data-path="point-pattern-analysis-iv.html"><a href="point-pattern-analysis-iv.html#k-function"><i class="fa fa-check"></i><b>14.7</b> K-function</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="point-pattern-analysis-iv-activity.html"><a href="point-pattern-analysis-iv-activity.html"><i class="fa fa-check"></i><b>15</b> Point Pattern Analysis IV-Activity</a><ul>
<li class="chapter" data-level="15.1" data-path="point-pattern-analysis-iv-activity.html"><a href="point-pattern-analysis-iv-activity.html#practice-questions-4"><i class="fa fa-check"></i><b>15.1</b> Practice questions</a></li>
<li class="chapter" data-level="15.2" data-path="point-pattern-analysis-iv-activity.html"><a href="point-pattern-analysis-iv-activity.html#learning-objectives-13"><i class="fa fa-check"></i><b>15.2</b> Learning objectives</a></li>
<li class="chapter" data-level="15.3" data-path="point-pattern-analysis-iv-activity.html"><a href="point-pattern-analysis-iv-activity.html#suggested-reading-11"><i class="fa fa-check"></i><b>15.3</b> Suggested reading</a></li>
<li class="chapter" data-level="15.4" data-path="point-pattern-analysis-iv-activity.html"><a href="point-pattern-analysis-iv-activity.html#preliminaries-13"><i class="fa fa-check"></i><b>15.4</b> Preliminaries</a></li>
<li class="chapter" data-level="15.5" data-path="point-pattern-analysis-iv-activity.html"><a href="point-pattern-analysis-iv-activity.html#activity-6"><i class="fa fa-check"></i><b>15.5</b> Activity</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="point-pattern-analysis-v.html"><a href="point-pattern-analysis-v.html"><i class="fa fa-check"></i><b>16</b> Point Pattern Analysis V</a><ul>
<li class="chapter" data-level="16.1" data-path="point-pattern-analysis-v.html"><a href="point-pattern-analysis-v.html#introduction-5"><i class="fa fa-check"></i><b>16.1</b> Introduction</a></li>
<li class="chapter" data-level="16.2" data-path="point-pattern-analysis-v.html"><a href="point-pattern-analysis-v.html#learning-objectives-14"><i class="fa fa-check"></i><b>16.2</b> Learning objectives</a></li>
<li class="chapter" data-level="16.3" data-path="point-pattern-analysis-v.html"><a href="point-pattern-analysis-v.html#suggested-reading-12"><i class="fa fa-check"></i><b>16.3</b> Suggested reading</a></li>
<li class="chapter" data-level="16.4" data-path="point-pattern-analysis-v.html"><a href="point-pattern-analysis-v.html#preliminaries-14"><i class="fa fa-check"></i><b>16.4</b> Preliminaries</a></li>
<li class="chapter" data-level="16.5" data-path="point-pattern-analysis-v.html"><a href="point-pattern-analysis-v.html#motivation-hypothesis-testing"><i class="fa fa-check"></i><b>16.5</b> Motivation: hypothesis testing</a></li>
<li class="chapter" data-level="16.6" data-path="point-pattern-analysis-v.html"><a href="point-pattern-analysis-v.html#null-landscapes-revisited"><i class="fa fa-check"></i><b>16.6</b> Null landscapes revisited</a></li>
<li class="chapter" data-level="16.7" data-path="point-pattern-analysis-v.html"><a href="point-pattern-analysis-v.html#simulation-envelopes"><i class="fa fa-check"></i><b>16.7</b> Simulation envelopes</a></li>
<li class="chapter" data-level="16.8" data-path="point-pattern-analysis-v.html"><a href="point-pattern-analysis-v.html#things-to-keep-in-mind"><i class="fa fa-check"></i><b>16.8</b> Things to keep in mind!</a><ul>
<li class="chapter" data-level="16.8.1" data-path="point-pattern-analysis-v.html"><a href="point-pattern-analysis-v.html#definition-of-a-region"><i class="fa fa-check"></i><b>16.8.1</b> Definition of a region</a></li>
<li class="chapter" data-level="16.8.2" data-path="point-pattern-analysis-v.html"><a href="point-pattern-analysis-v.html#edge-effects"><i class="fa fa-check"></i><b>16.8.2</b> Edge effects</a></li>
<li class="chapter" data-level="16.8.3" data-path="point-pattern-analysis-v.html"><a href="point-pattern-analysis-v.html#sampled-point-patterns"><i class="fa fa-check"></i><b>16.8.3</b> Sampled point patterns</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="point-pattern-analysis-v-activity.html"><a href="point-pattern-analysis-v-activity.html"><i class="fa fa-check"></i><b>17</b> Point Pattern Analysis V-Activity</a><ul>
<li class="chapter" data-level="17.1" data-path="point-pattern-analysis-v-activity.html"><a href="point-pattern-analysis-v-activity.html#practice-questions-5"><i class="fa fa-check"></i><b>17.1</b> Practice questions</a></li>
<li class="chapter" data-level="17.2" data-path="point-pattern-analysis-v-activity.html"><a href="point-pattern-analysis-v-activity.html#learning-objectives-15"><i class="fa fa-check"></i><b>17.2</b> Learning objectives</a></li>
<li class="chapter" data-level="17.3" data-path="point-pattern-analysis-v-activity.html"><a href="point-pattern-analysis-v-activity.html#suggested-reading-13"><i class="fa fa-check"></i><b>17.3</b> Suggested reading</a></li>
<li class="chapter" data-level="17.4" data-path="point-pattern-analysis-v-activity.html"><a href="point-pattern-analysis-v-activity.html#preliminaries-15"><i class="fa fa-check"></i><b>17.4</b> Preliminaries</a></li>
<li class="chapter" data-level="17.5" data-path="point-pattern-analysis-v-activity.html"><a href="point-pattern-analysis-v-activity.html#activity-7"><i class="fa fa-check"></i><b>17.5</b> Activity</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="area-data-i.html"><a href="area-data-i.html"><i class="fa fa-check"></i><b>18</b> Area Data I</a><ul>
<li class="chapter" data-level="18.1" data-path="area-data-i.html"><a href="area-data-i.html#introduction-6"><i class="fa fa-check"></i><b>18.1</b> Introduction</a></li>
<li class="chapter" data-level="18.2" data-path="area-data-i.html"><a href="area-data-i.html#learning-objectives-16"><i class="fa fa-check"></i><b>18.2</b> Learning objectives</a></li>
<li class="chapter" data-level="18.3" data-path="area-data-i.html"><a href="area-data-i.html#suggested-reading-14"><i class="fa fa-check"></i><b>18.3</b> Suggested reading</a></li>
<li class="chapter" data-level="18.4" data-path="area-data-i.html"><a href="area-data-i.html#preliminaries-16"><i class="fa fa-check"></i><b>18.4</b> Preliminaries</a></li>
<li class="chapter" data-level="18.5" data-path="area-data-i.html"><a href="area-data-i.html#area-data"><i class="fa fa-check"></i><b>18.5</b> Area data</a></li>
<li class="chapter" data-level="18.6" data-path="area-data-i.html"><a href="area-data-i.html#processes-and-area-data"><i class="fa fa-check"></i><b>18.6</b> Processes and area data</a></li>
<li class="chapter" data-level="18.7" data-path="area-data-i.html"><a href="area-data-i.html#visualizing-area-data-choropleth-maps"><i class="fa fa-check"></i><b>18.7</b> Visualizing area data: choropleth maps</a></li>
<li class="chapter" data-level="18.8" data-path="area-data-i.html"><a href="area-data-i.html#visualizing-area-data-cartogram"><i class="fa fa-check"></i><b>18.8</b> Visualizing area data: cartogram</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="area-data-i-activity.html"><a href="area-data-i-activity.html"><i class="fa fa-check"></i><b>19</b> Area Data I-Activity</a><ul>
<li class="chapter" data-level="19.1" data-path="area-data-i-activity.html"><a href="area-data-i-activity.html#practice-questions-6"><i class="fa fa-check"></i><b>19.1</b> Practice questions</a></li>
<li class="chapter" data-level="19.2" data-path="area-data-i-activity.html"><a href="area-data-i-activity.html#learning-objectives-17"><i class="fa fa-check"></i><b>19.2</b> Learning objectives</a></li>
<li class="chapter" data-level="19.3" data-path="area-data-i-activity.html"><a href="area-data-i-activity.html#suggested-reading-15"><i class="fa fa-check"></i><b>19.3</b> Suggested reading</a></li>
<li class="chapter" data-level="19.4" data-path="area-data-i-activity.html"><a href="area-data-i-activity.html#preliminaries-17"><i class="fa fa-check"></i><b>19.4</b> Preliminaries</a></li>
<li class="chapter" data-level="19.5" data-path="area-data-i-activity.html"><a href="area-data-i-activity.html#activity-8"><i class="fa fa-check"></i><b>19.5</b> Activity</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="area-data-i-bonus-material.html"><a href="area-data-i-bonus-material.html"><i class="fa fa-check"></i><b>20</b> Area Data I - Bonus Material</a><ul>
<li class="chapter" data-level="20.1" data-path="area-data-i-bonus-material.html"><a href="area-data-i-bonus-material.html#preliminaries-18"><i class="fa fa-check"></i><b>20.1</b> Preliminaries</a></li>
<li class="chapter" data-level="20.2" data-path="area-data-i-bonus-material.html"><a href="area-data-i-bonus-material.html#activity-9"><i class="fa fa-check"></i><b>20.2</b> Activity</a></li>
<li class="chapter" data-level="20.3" data-path="area-data-i-bonus-material.html"><a href="area-data-i-bonus-material.html#bonus"><i class="fa fa-check"></i><b>20.3</b> Bonus</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="area-data-ii.html"><a href="area-data-ii.html"><i class="fa fa-check"></i><b>21</b> Area Data II</a><ul>
<li class="chapter" data-level="21.1" data-path="area-data-ii.html"><a href="area-data-ii.html#introduction-7"><i class="fa fa-check"></i><b>21.1</b> Introduction</a></li>
<li class="chapter" data-level="21.2" data-path="area-data-ii.html"><a href="area-data-ii.html#learning-objectives-18"><i class="fa fa-check"></i><b>21.2</b> Learning objectives</a></li>
<li class="chapter" data-level="21.3" data-path="area-data-ii.html"><a href="area-data-ii.html#suggested-reading-16"><i class="fa fa-check"></i><b>21.3</b> Suggested reading</a></li>
<li class="chapter" data-level="21.4" data-path="area-data-ii.html"><a href="area-data-ii.html#preliminaries-19"><i class="fa fa-check"></i><b>21.4</b> Preliminaries</a></li>
<li class="chapter" data-level="21.5" data-path="area-data-ii.html"><a href="area-data-ii.html#proximity-in-area-data"><i class="fa fa-check"></i><b>21.5</b> Proximity in area data</a></li>
<li class="chapter" data-level="21.6" data-path="area-data-ii.html"><a href="area-data-ii.html#spatial-weights-matrices"><i class="fa fa-check"></i><b>21.6</b> Spatial weights matrices</a></li>
<li class="chapter" data-level="21.7" data-path="area-data-ii.html"><a href="area-data-ii.html#creating-spatial-weights-matrices-in-r"><i class="fa fa-check"></i><b>21.7</b> Creating spatial weights matrices in R</a></li>
<li class="chapter" data-level="21.8" data-path="area-data-ii.html"><a href="area-data-ii.html#spatial-moving-averages"><i class="fa fa-check"></i><b>21.8</b> Spatial moving averages</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="area-data-ii-activity.html"><a href="area-data-ii-activity.html"><i class="fa fa-check"></i><b>22</b> Area Data II-Activity</a><ul>
<li class="chapter" data-level="22.1" data-path="area-data-ii-activity.html"><a href="area-data-ii-activity.html#practice-questions-7"><i class="fa fa-check"></i><b>22.1</b> Practice questions</a></li>
<li class="chapter" data-level="22.2" data-path="area-data-ii-activity.html"><a href="area-data-ii-activity.html#learning-objectives-19"><i class="fa fa-check"></i><b>22.2</b> Learning objectives</a></li>
<li class="chapter" data-level="22.3" data-path="area-data-ii-activity.html"><a href="area-data-ii-activity.html#suggested-reading-17"><i class="fa fa-check"></i><b>22.3</b> Suggested reading</a></li>
<li class="chapter" data-level="22.4" data-path="area-data-ii-activity.html"><a href="area-data-ii-activity.html#preliminaries-20"><i class="fa fa-check"></i><b>22.4</b> Preliminaries</a></li>
<li class="chapter" data-level="22.5" data-path="area-data-ii-activity.html"><a href="area-data-ii-activity.html#activity-10"><i class="fa fa-check"></i><b>22.5</b> Activity</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="area-data-iii.html"><a href="area-data-iii.html"><i class="fa fa-check"></i><b>23</b> Area Data III</a><ul>
<li class="chapter" data-level="23.1" data-path="area-data-iii.html"><a href="area-data-iii.html#introduction-8"><i class="fa fa-check"></i><b>23.1</b> Introduction</a></li>
<li class="chapter" data-level="23.2" data-path="area-data-iii.html"><a href="area-data-iii.html#learning-objectives-20"><i class="fa fa-check"></i><b>23.2</b> Learning objectives</a></li>
<li class="chapter" data-level="23.3" data-path="area-data-iii.html"><a href="area-data-iii.html#suggested-reading-18"><i class="fa fa-check"></i><b>23.3</b> Suggested reading</a></li>
<li class="chapter" data-level="23.4" data-path="area-data-iii.html"><a href="area-data-iii.html#preliminaries-21"><i class="fa fa-check"></i><b>23.4</b> Preliminaries</a></li>
<li class="chapter" data-level="23.5" data-path="area-data-iii.html"><a href="area-data-iii.html#spatial-moving-averages-and-simulation"><i class="fa fa-check"></i><b>23.5</b> Spatial moving averages and simulation</a><ul>
<li class="chapter" data-level="23.5.1" data-path="area-data-iii.html"><a href="area-data-iii.html#spatial-moving-average-as-a-smoother"><i class="fa fa-check"></i><b>23.5.1</b> Spatial moving average as a smoother</a></li>
<li class="chapter" data-level="23.5.2" data-path="area-data-iii.html"><a href="area-data-iii.html#spatial-moving-average-scatterplots"><i class="fa fa-check"></i><b>23.5.2</b> Spatial moving average scatterplots</a></li>
</ul></li>
<li class="chapter" data-level="23.6" data-path="area-data-iii.html"><a href="area-data-iii.html#spatial-autocorrelation-and-morans-i-coefficient"><i class="fa fa-check"></i><b>23.6</b> Spatial autocorrelation and Moran’s I coefficient</a></li>
<li class="chapter" data-level="23.7" data-path="area-data-iii.html"><a href="area-data-iii.html#morans-i-and-morans-scatterplot"><i class="fa fa-check"></i><b>23.7</b> Moran’s I and Moran’s scatterplot</a></li>
<li class="chapter" data-level="23.8" data-path="area-data-iii.html"><a href="area-data-iii.html#hypothesis-testing-for-spatial-autocorrelation"><i class="fa fa-check"></i><b>23.8</b> Hypothesis testing for spatial autocorrelation</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="area-data-iii-activity.html"><a href="area-data-iii-activity.html"><i class="fa fa-check"></i><b>24</b> Area Data III-Activity</a><ul>
<li class="chapter" data-level="24.1" data-path="area-data-iii-activity.html"><a href="area-data-iii-activity.html#practice-questions-8"><i class="fa fa-check"></i><b>24.1</b> Practice questions</a></li>
<li class="chapter" data-level="24.2" data-path="area-data-iii-activity.html"><a href="area-data-iii-activity.html#learning-objectives-21"><i class="fa fa-check"></i><b>24.2</b> Learning objectives</a></li>
<li class="chapter" data-level="24.3" data-path="area-data-iii-activity.html"><a href="area-data-iii-activity.html#suggested-reading-19"><i class="fa fa-check"></i><b>24.3</b> Suggested reading</a></li>
<li class="chapter" data-level="24.4" data-path="area-data-iii-activity.html"><a href="area-data-iii-activity.html#preliminaries-22"><i class="fa fa-check"></i><b>24.4</b> Preliminaries</a></li>
<li class="chapter" data-level="24.5" data-path="area-data-iii-activity.html"><a href="area-data-iii-activity.html#activity-11"><i class="fa fa-check"></i><b>24.5</b> Activity</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="area-data-iv.html"><a href="area-data-iv.html"><i class="fa fa-check"></i><b>25</b> Area Data IV</a><ul>
<li class="chapter" data-level="25.1" data-path="area-data-iv.html"><a href="area-data-iv.html#introduction-9"><i class="fa fa-check"></i><b>25.1</b> Introduction</a></li>
<li class="chapter" data-level="25.2" data-path="area-data-iv.html"><a href="area-data-iv.html#learning-objectives-22"><i class="fa fa-check"></i><b>25.2</b> Learning objectives</a></li>
<li class="chapter" data-level="25.3" data-path="area-data-iv.html"><a href="area-data-iv.html#suggested-reading-20"><i class="fa fa-check"></i><b>25.3</b> Suggested reading</a></li>
<li class="chapter" data-level="25.4" data-path="area-data-iv.html"><a href="area-data-iv.html#preliminaries-23"><i class="fa fa-check"></i><b>25.4</b> Preliminaries</a></li>
<li class="chapter" data-level="25.5" data-path="area-data-iv.html"><a href="area-data-iv.html#decomposing-morans-i"><i class="fa fa-check"></i><b>25.5</b> Decomposing Moran’s I</a></li>
<li class="chapter" data-level="25.6" data-path="area-data-iv.html"><a href="area-data-iv.html#local-morans-i-and-mapping"><i class="fa fa-check"></i><b>25.6</b> Local Moran’s I and mapping</a><ul>
<li class="chapter" data-level="25.6.1" data-path="area-data-iv.html"><a href="area-data-iv.html#a-quick-note-on-functions"><i class="fa fa-check"></i><b>25.6.1</b> A quick note on functions</a></li>
</ul></li>
<li class="chapter" data-level="25.7" data-path="area-data-iv.html"><a href="area-data-iv.html#a-concentration-approach-for-local-analysis-of-spatial-association"><i class="fa fa-check"></i><b>25.7</b> A concentration approach for local analysis of spatial association</a></li>
<li class="chapter" data-level="25.8" data-path="area-data-iv.html"><a href="area-data-iv.html#a-short-note-on-hypothesis-testing"><i class="fa fa-check"></i><b>25.8</b> A short note on hypothesis testing</a></li>
<li class="chapter" data-level="25.9" data-path="area-data-iv.html"><a href="area-data-iv.html#detection-of-hot-and-cold-spots"><i class="fa fa-check"></i><b>25.9</b> Detection of hot and cold spots</a></li>
<li class="chapter" data-level="25.10" data-path="area-data-iv.html"><a href="area-data-iv.html#bonus-1"><i class="fa fa-check"></i><b>25.10</b> Bonus</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="area-data-iv-activity.html"><a href="area-data-iv-activity.html"><i class="fa fa-check"></i><b>26</b> Area Data IV-Activity</a><ul>
<li class="chapter" data-level="26.1" data-path="area-data-iv-activity.html"><a href="area-data-iv-activity.html#practice-questions-9"><i class="fa fa-check"></i><b>26.1</b> Practice questions</a></li>
<li class="chapter" data-level="26.2" data-path="area-data-iv-activity.html"><a href="area-data-iv-activity.html#learning-objectives-23"><i class="fa fa-check"></i><b>26.2</b> Learning objectives</a></li>
<li class="chapter" data-level="26.3" data-path="area-data-iv-activity.html"><a href="area-data-iv-activity.html#suggested-reading-21"><i class="fa fa-check"></i><b>26.3</b> Suggested reading</a></li>
<li class="chapter" data-level="26.4" data-path="area-data-iv-activity.html"><a href="area-data-iv-activity.html#preliminaries-24"><i class="fa fa-check"></i><b>26.4</b> Preliminaries</a></li>
<li class="chapter" data-level="26.5" data-path="area-data-iv-activity.html"><a href="area-data-iv-activity.html#activity-12"><i class="fa fa-check"></i><b>26.5</b> Activity</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="area-data-v.html"><a href="area-data-v.html"><i class="fa fa-check"></i><b>27</b> Area Data V</a><ul>
<li class="chapter" data-level="27.1" data-path="area-data-v.html"><a href="area-data-v.html#introduction-10"><i class="fa fa-check"></i><b>27.1</b> Introduction</a></li>
<li class="chapter" data-level="27.2" data-path="area-data-v.html"><a href="area-data-v.html#learning-objectives-24"><i class="fa fa-check"></i><b>27.2</b> Learning objectives</a></li>
<li class="chapter" data-level="27.3" data-path="area-data-v.html"><a href="area-data-v.html#suggested-reading-22"><i class="fa fa-check"></i><b>27.3</b> Suggested reading</a></li>
<li class="chapter" data-level="27.4" data-path="area-data-v.html"><a href="area-data-v.html#preliminaries-25"><i class="fa fa-check"></i><b>27.4</b> Preliminaries</a></li>
<li class="chapter" data-level="27.5" data-path="area-data-v.html"><a href="area-data-v.html#regression-analysis-in-r"><i class="fa fa-check"></i><b>27.5</b> Regression analysis in R</a></li>
<li class="chapter" data-level="27.6" data-path="area-data-v.html"><a href="area-data-v.html#autocorrelation-as-a-model-diagnostic"><i class="fa fa-check"></i><b>27.6</b> Autocorrelation as a model diagnostic</a></li>
<li class="chapter" data-level="27.7" data-path="area-data-v.html"><a href="area-data-v.html#variable-transformations"><i class="fa fa-check"></i><b>27.7</b> Variable transformations</a></li>
<li class="chapter" data-level="27.8" data-path="area-data-v.html"><a href="area-data-v.html#a-note-about-spatial-autocorrelation-in-regression-analysis"><i class="fa fa-check"></i><b>27.8</b> A note about spatial autocorrelation in regression analysis</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="area-data-v-activity.html"><a href="area-data-v-activity.html"><i class="fa fa-check"></i><b>28</b> Area Data V-Activity</a><ul>
<li class="chapter" data-level="28.1" data-path="area-data-v-activity.html"><a href="area-data-v-activity.html#practice-questions-10"><i class="fa fa-check"></i><b>28.1</b> Practice questions</a></li>
<li class="chapter" data-level="28.2" data-path="area-data-v-activity.html"><a href="area-data-v-activity.html#learning-objectives-25"><i class="fa fa-check"></i><b>28.2</b> Learning objectives</a></li>
<li class="chapter" data-level="28.3" data-path="area-data-v-activity.html"><a href="area-data-v-activity.html#suggested-reading-23"><i class="fa fa-check"></i><b>28.3</b> Suggested reading</a></li>
<li class="chapter" data-level="28.4" data-path="area-data-v-activity.html"><a href="area-data-v-activity.html#preliminaries-26"><i class="fa fa-check"></i><b>28.4</b> Preliminaries</a></li>
<li class="chapter" data-level="28.5" data-path="area-data-v-activity.html"><a href="area-data-v-activity.html#activity-13"><i class="fa fa-check"></i><b>28.5</b> Activity</a></li>
</ul></li>
<li class="chapter" data-level="29" data-path="area-data-vi.html"><a href="area-data-vi.html"><i class="fa fa-check"></i><b>29</b> Area Data VI</a><ul>
<li class="chapter" data-level="29.1" data-path="area-data-vi.html"><a href="area-data-vi.html#introduction-11"><i class="fa fa-check"></i><b>29.1</b> Introduction</a></li>
<li class="chapter" data-level="29.2" data-path="area-data-vi.html"><a href="area-data-vi.html#learning-objectives-26"><i class="fa fa-check"></i><b>29.2</b> Learning objectives</a></li>
<li class="chapter" data-level="29.3" data-path="area-data-vi.html"><a href="area-data-vi.html#suggested-reading-24"><i class="fa fa-check"></i><b>29.3</b> Suggested reading</a></li>
<li class="chapter" data-level="29.4" data-path="area-data-vi.html"><a href="area-data-vi.html#preliminaries-27"><i class="fa fa-check"></i><b>29.4</b> Preliminaries</a></li>
<li class="chapter" data-level="29.5" data-path="area-data-vi.html"><a href="area-data-vi.html#residual-spatial-autocorrelation-revisited"><i class="fa fa-check"></i><b>29.5</b> Residual spatial autocorrelation revisited</a><ul>
<li class="chapter" data-level="29.5.1" data-path="area-data-vi.html"><a href="area-data-vi.html#incorrect-functional-form"><i class="fa fa-check"></i><b>29.5.1</b> Incorrect functional form</a></li>
<li class="chapter" data-level="29.5.2" data-path="area-data-vi.html"><a href="area-data-vi.html#omitted-variables"><i class="fa fa-check"></i><b>29.5.2</b> Omitted variables</a></li>
</ul></li>
<li class="chapter" data-level="29.6" data-path="area-data-vi.html"><a href="area-data-vi.html#remedial-action"><i class="fa fa-check"></i><b>29.6</b> Remedial action</a></li>
<li class="chapter" data-level="29.7" data-path="area-data-vi.html"><a href="area-data-vi.html#flexible-functional-forms-and-models-with-spatially-varying-coefficients"><i class="fa fa-check"></i><b>29.7</b> Flexible functional forms and models with spatially-varying coefficients</a><ul>
<li class="chapter" data-level="29.7.1" data-path="area-data-vi.html"><a href="area-data-vi.html#trend-surface-analysis"><i class="fa fa-check"></i><b>29.7.1</b> Trend surface analysis</a></li>
<li class="chapter" data-level="29.7.2" data-path="area-data-vi.html"><a href="area-data-vi.html#models-with-spatially-varying-coefficients"><i class="fa fa-check"></i><b>29.7.2</b> Models with spatially varying coefficients</a></li>
</ul></li>
<li class="chapter" data-level="29.8" data-path="area-data-vi.html"><a href="area-data-vi.html#spatial-error-model-sem"><i class="fa fa-check"></i><b>29.8</b> Spatial Error Model (SEM)</a></li>
</ul></li>
<li class="chapter" data-level="30" data-path="area-data-vi-activity.html"><a href="area-data-vi-activity.html"><i class="fa fa-check"></i><b>30</b> Area Data VI-Activity</a><ul>
<li class="chapter" data-level="30.1" data-path="area-data-vi-activity.html"><a href="area-data-vi-activity.html#practice-questions-11"><i class="fa fa-check"></i><b>30.1</b> Practice questions</a></li>
<li class="chapter" data-level="30.2" data-path="area-data-vi-activity.html"><a href="area-data-vi-activity.html#learning-objectives-27"><i class="fa fa-check"></i><b>30.2</b> Learning objectives</a></li>
<li class="chapter" data-level="30.3" data-path="area-data-vi-activity.html"><a href="area-data-vi-activity.html#suggested-reading-25"><i class="fa fa-check"></i><b>30.3</b> Suggested reading</a></li>
<li class="chapter" data-level="30.4" data-path="area-data-vi-activity.html"><a href="area-data-vi-activity.html#preliminaries-28"><i class="fa fa-check"></i><b>30.4</b> Preliminaries</a><ul>
<li class="chapter" data-level="30.4.1" data-path="area-data-vi-activity.html"><a href="area-data-vi-activity.html#new-york-leukemia-data"><i class="fa fa-check"></i><b>30.4.1</b> New York leukemia data</a></li>
<li class="chapter" data-level="30.4.2" data-path="area-data-vi-activity.html"><a href="area-data-vi-activity.html#pennsylvania-lung-cancer"><i class="fa fa-check"></i><b>30.4.2</b> Pennsylvania lung cancer</a></li>
</ul></li>
<li class="chapter" data-level="30.5" data-path="area-data-vi-activity.html"><a href="area-data-vi-activity.html#activity-14"><i class="fa fa-check"></i><b>30.5</b> Activity</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Practical Data Analysis for the Spatial Sciences in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="point-pattern-analysis-ii" class="section level1">
<h1><span class="header-section-number">10</span> Point Pattern Analysis II</h1>
<div id="introduction-2" class="section level2">
<h2><span class="header-section-number">10.1</span> Introduction</h2>
<p>NOTE: This is an <a href="http://rmarkdown.rstudio.com">R Markdown</a> Notebook. When you execute code within the notebook, the results appear beneath the code.</p>
<p>In the last practice/session your learning objectives included:</p>
<ol style="list-style-type: decimal">
<li>A formal definition of point pattern.</li>
<li>Processes and point patterns.</li>
<li>The concepts of intensity and density.</li>
<li>The concept of quadrats and how to create density maps.</li>
<li>More ways to control the look of your plots, in particular faceting and adding lines.</li>
</ol>
<p>Please review the previous practices if you need a refresher on these concepts.</p>
<p>For this practice you will need the following:</p>
<ul>
<li>This R markdown notebook.</li>
<li>Datasets called <code>Data3.RData</code> and <code>Data4.RData</code>.</li>
</ul>
<p><code>Data3.RData</code> includes a dataframe with four sets of spatial events, labeled as “Pattern 1”, “Pattern 2”, “Pattern 3”, “PointPattern4”, with n = 60 events in each set.</p>
<p><code>Data4.RData</code> includes a <code>spatstat</code> <code>ppp</code>-class object with two sets of spatial events, labeled as “Pattern 1” and “Pattern 2”</p>
</div>
<div id="learning-objectives-8" class="section level2">
<h2><span class="header-section-number">10.2</span> Learning objectives</h2>
<p>In this practice, you will learn:</p>
<ol style="list-style-type: decimal">
<li>The intuition behind the quadrat-based test of independence.</li>
<li>About the limitations of quadrat-based analysis.</li>
<li>The concept of kernel density.</li>
<li>More ways to manipulate objects to do point pattern analysis using <code>spatstat</code>.</li>
</ol>
</div>
<div id="suggested-reading-6" class="section level2">
<h2><span class="header-section-number">10.3</span> Suggested reading</h2>
<p>O’Sullivan D and Unwin D (2010) Geographic Information Analysis, 2nd Edition, Chapter 5. John Wiley &amp; Sons: New Jersey.</p>
</div>
<div id="preliminaries-8" class="section level2">
<h2><span class="header-section-number">10.4</span> Preliminaries</h2>
<p>As usual, it is good practice to clear the working space to make sure that you do not have extraneous items there when you begin your work. The command in R to clear the workspace is <code>rm</code> (for “remove”), followed by a list of items to be removed. To clear the workspace from <em>all</em> objects, do the following:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</code></pre></div>
<p>Note that <code>ls()</code> lists all objects currently on the worspace.</p>
<p>Load the libraries you will use in this activity:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(spatstat)</code></pre></div>
<p>Load the datasets that you will use for this practice:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="st">&quot;Data3.RData&quot;</span>)
<span class="kw">load</span>(<span class="st">&quot;Data4.RData&quot;</span>)</code></pre></div>
<p>There is a dataframe called <code>PointPatterns</code>. You can check this by means of the function class <code>class()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(PointPatterns)</code></pre></div>
<pre><code>## [1] &quot;data.frame&quot;</code></pre>
<p>In addition, there is a <code>ppp</code> object with two point patterns:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(pp1)</code></pre></div>
<pre><code>## [1] &quot;ppp&quot;</code></pre>
<p>The summary for <code>PointPatterns</code> shows that these point patterns are located in a square-unit window (check the max and min values of x and y):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(PointPatterns)</code></pre></div>
<pre><code>##        x                y                 Pattern  
##  Min.   :0.0169   Min.   :0.005306   Pattern 1:60  
##  1st Qu.:0.2731   1st Qu.:0.289020   Pattern 2:60  
##  Median :0.4854   Median :0.550000   Pattern 3:60  
##  Mean   :0.5074   Mean   :0.538733   Pattern 4:60  
##  3rd Qu.:0.7616   3rd Qu.:0.797850                 
##  Max.   :0.9990   Max.   :0.999808</code></pre>
<p>As seen in the previous practice and activity, the package <code>spatstat</code> employs a type of object called <code>ppp</code> (for <em>p</em>lanar <em>p</em>oint <em>p</em>attern). Fortunately, it is relatively simple to convert a dataframe into a <code>ppp</code> object by means of <code>as.ppp()</code>. This function requires that you define a window for the point pattern, something we can do by means of the <code>owin</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">W &lt;-<span class="st"> </span><span class="kw">owin</span>(<span class="dt">xrange =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">yrange =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</code></pre></div>
<p>Now you can convert the dataframe into a <code>ppp</code> object:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">PointPatterns.ppp &lt;-<span class="st"> </span><span class="kw">as.ppp</span>(PointPatterns, W)</code></pre></div>
</div>
<div id="a-quadrat-based-test-for-spatial-independence" class="section level2">
<h2><span class="header-section-number">10.5</span> A quadrat-based test for spatial independence</h2>
<p>In the preceding activity, you used a quadrat-based spatial independence test to help you decide whether a pattern was random (the function was <code>quadrat.test</code>). We will now review the intuition of the test.</p>
<p>Let’s begin by plotting the patterns. You can use <code>split</code> to do plots for each pattern separately, instead of putting all of them in a single plot (these plots are not as responsive as <code>ggplot2</code> but are quick):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">split</span>(PointPatterns.ppp))</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-133-1.png" width="672" /></p>
<p>Notice that you can also plot individual patterns by using <code>$</code> followed by the factor that identifies the desired pattern:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">split</span>(PointPatterns.ppp)$<span class="st">&quot;Pattern 4&quot;</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-134-1.png" width="672" /></p>
<p>Now calculate the quadrat-based test of independence:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">q_test &lt;-<span class="st"> </span><span class="kw">quadrat.test</span>(<span class="kw">split</span>(PointPatterns.ppp)$<span class="st">&quot;Pattern 2&quot;</span>, <span class="dt">nx =</span> <span class="dv">3</span>, <span class="dt">ny =</span> <span class="dv">3</span>)
q_test</code></pre></div>
<pre><code>## 
##  Chi-squared test of CSR using quadrat counts
##  Pearson X2 statistic
## 
## data:  split(PointPatterns.ppp)$&quot;Pattern 2&quot;
## X2 = 48, df = 8, p-value = 1.976e-07
## alternative hypothesis: two.sided
## 
## Quadrats: 3 by 3 grid of tiles</code></pre>
<p>Plot the results of the quadrat test:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(q_test)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-136-1.png" width="672" /></p>
<p>As discussed in the previous session, the expected distribution of events on quadrats under the null landscape tends to be quite even. This is because each quadrat has equal probability of having the same number of events (depending on size, when the quadrats are not all the same size).</p>
<p>If you check the plot of the quadrat test above, you will notice that the first number (top left corner) is the number of events in the quadrat. The second number (top right corner) is the <em>expected number of events</em> for a null landscape. The third number is a <em>residual</em>, based on the difference between the observed and expected number of events.</p>
<p>More specifically, the residual is a <em>Pearson residual</em>, defined as follows: <span class="math display">\[
r_i=\frac{O_i - E_i}{\sqrt{E_i}},
\]</span> where <span class="math inline">\(O_i\)</span> is the number of observed events in quadrat <span class="math inline">\(i\)</span> and <span class="math inline">\(E_i\)</span> is the number of expected events in quadrat <span class="math inline">\(i\)</span>.</p>
<p>When the number of observed events is similar to the number of expected events, <span class="math inline">\(r_i\)</span> will tend to be a small value. As the difference grows, the residual will also grow.</p>
<p>The independence test is calculated from the residuals as: <span class="math display">\[
X2=\sum_{i=1}^{Q}r_i^2,
\]</span> where <span class="math inline">\(Q\)</span> is the number of quadrats. In other words, the test is based on the squared sum of the Pearson residuals. The smaller this number is, the more likely that it is not different from the null landscape (i.e., a random process), and the larger it is, the more likely that it is different from the null landscape. This is reflected by the p-value of the test (technically, the p-value is obtained from comparing the test to the Chi-square distribution).</p>
<p>Consider for instance the first pattern in the examples:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">quadrat.test</span>(<span class="kw">split</span>(PointPatterns.ppp)$<span class="st">&quot;Pattern 1&quot;</span>, <span class="dt">nx =</span> <span class="dv">3</span>, <span class="dt">ny =</span> <span class="dv">3</span>))</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-137-1.png" width="672" /></p>
<p>You can see that the Pearson residual of the top left quadrat is indeed -0.6567673, the next to its right is -0.2704336, and so on. The value of the test statistic should be then:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">paste</span>(<span class="st">&quot;X2 = &quot;</span>, (-<span class="fl">0.65</span>)^<span class="dv">2</span> +<span class="st"> </span>(-<span class="fl">0.26</span>)^<span class="dv">2</span> +<span class="st"> </span>(<span class="fl">0.52</span>)^<span class="dv">2</span> +<span class="st"> </span>(-<span class="fl">0.26</span>)^<span class="dv">2</span> +<span class="st"> </span>(<span class="fl">0.9</span>)^<span class="dv">2</span> +<span class="st"> </span>(<span class="fl">0.52</span>)^<span class="dv">2</span> +<span class="st"> </span>(-<span class="dv">1</span>)^<span class="dv">2</span> +<span class="st"> </span>(<span class="fl">0.13</span>)^<span class="dv">2</span> +<span class="st"> </span>(<span class="fl">0.13</span>)^<span class="dv">2</span>)</code></pre></div>
<pre><code>## [1] &quot;X2 =  2.9423&quot;</code></pre>
<p>Which you can confirm by examining the results of the test (the small difference is due to rounding errors):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">quadrat.test</span>(<span class="kw">split</span>(PointPatterns.ppp)$<span class="st">&quot;Pattern 1&quot;</span>, <span class="dt">nx =</span> <span class="dv">3</span>, <span class="dt">ny =</span> <span class="dv">3</span>)</code></pre></div>
<pre><code>## 
##  Chi-squared test of CSR using quadrat counts
##  Pearson X2 statistic
## 
## data:  split(PointPatterns.ppp)$&quot;Pattern 1&quot;
## X2 = 3, df = 8, p-value = 0.1313
## alternative hypothesis: two.sided
## 
## Quadrats: 3 by 3 grid of tiles</code></pre>
<p>Explore the remaining patterns. You will notice that the residuals and test statistic tend to grow as more events are concentrated in space. In this way, the test is a test of density of the quadrats: is their density similar to what would be expected from a null landscape?</p>
</div>
<div id="limitations-of-quadrat-analysis-size-and-number-of-quadrats" class="section level2">
<h2><span class="header-section-number">10.6</span> Limitations of quadrat analysis: size and number of quadrats</h2>
<p>As hinted by the previous activity, one issue with quadrat analysis is the selection of the size for the quadrats. Changing the size of the quadrats has an impact on the counts, and in turn on the aspect of density plots and even the results of the test of independence.</p>
<p>For example, the results of the test for “Pattern 2” in the dataset change when the number of quadrats is modified. For instance, with a small number of quadrats:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">quadrat.test</span>(<span class="kw">split</span>(PointPatterns.ppp)$<span class="st">&quot;Pattern 2&quot;</span>, <span class="dt">nx =</span> <span class="dv">2</span>, <span class="dt">ny =</span> <span class="dv">1</span>)</code></pre></div>
<pre><code>## 
##  Chi-squared test of CSR using quadrat counts
##  Pearson X2 statistic
## 
## data:  split(PointPatterns.ppp)$&quot;Pattern 2&quot;
## X2 = 1.6667, df = 1, p-value = 0.3934
## alternative hypothesis: two.sided
## 
## Quadrats: 2 by 1 grid of tiles</code></pre>
<p>Compare to four quadrats:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">quadrat.test</span>(<span class="kw">split</span>(PointPatterns.ppp)$<span class="st">&quot;Pattern 2&quot;</span>, <span class="dt">nx =</span> <span class="dv">2</span>, <span class="dt">ny =</span> <span class="dv">2</span>)</code></pre></div>
<pre><code>## 
##  Chi-squared test of CSR using quadrat counts
##  Pearson X2 statistic
## 
## data:  split(PointPatterns.ppp)$&quot;Pattern 2&quot;
## X2 = 6, df = 3, p-value = 0.2232
## alternative hypothesis: two.sided
## 
## Quadrats: 2 by 2 grid of tiles</code></pre>
<p>And:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">quadrat.test</span>(<span class="kw">split</span>(PointPatterns.ppp)$<span class="st">&quot;Pattern 2&quot;</span>, <span class="dt">nx =</span> <span class="dv">3</span>, <span class="dt">ny =</span> <span class="dv">2</span>)</code></pre></div>
<pre><code>## 
##  Chi-squared test of CSR using quadrat counts
##  Pearson X2 statistic
## 
## data:  split(PointPatterns.ppp)$&quot;Pattern 2&quot;
## X2 = 23.2, df = 5, p-value = 0.0006182
## alternative hypothesis: two.sided
## 
## Quadrats: 3 by 2 grid of tiles</code></pre>
<p>Why is the statistic generally smaller when there are fewer quadrats?</p>
<p>A different issue emerges when the number of quadrats is large:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">quadrat.test</span>(<span class="kw">split</span>(PointPatterns.ppp)$<span class="st">&quot;Pattern 2&quot;</span>, <span class="dt">nx =</span> <span class="dv">4</span>, <span class="dt">ny =</span> <span class="dv">4</span>)</code></pre></div>
<pre><code>## Warning: Some expected counts are small; chi^2 approximation may be
## inaccurate</code></pre>
<pre><code>## 
##  Chi-squared test of CSR using quadrat counts
##  Pearson X2 statistic
## 
## data:  split(PointPatterns.ppp)$&quot;Pattern 2&quot;
## X2 = 47.2, df = 15, p-value = 6.84e-05
## alternative hypothesis: two.sided
## 
## Quadrats: 4 by 4 grid of tiles</code></pre>
<p>A warning now tells you that some expected counts are small: space has been divided so minutely, that the expected number of events per quadrat has become too thin; as a consequence, the approximation to the probability distribution may be inaccurate.</p>
<p>While there are no hard rules to select the size/number of quadrats, the following rules of thumb are sometimes suggested:</p>
<ol style="list-style-type: decimal">
<li>Each quadrat should have a minimum of two events.</li>
<li>The number of quadrats is selected based on the area (A) of the region, and the number of events (n): <span class="math display">\[
Q=\frac{2A}{N}
\]</span> Caution should be exercised when interpreting the results of the analysis based on quadrats, due to the issue of size/number of quadrats.</li>
</ol>
</div>
<div id="limitations-of-quadrat-analysis-relative-position-of-events" class="section level2">
<h2><span class="header-section-number">10.7</span> Limitations of quadrat analysis: relative position of events</h2>
<p>Another issue with quadrat analysis is its insensibility to the relative position of the events within the quadrats.</p>
<p>Consider for instance the following two patterns in <code>pp1</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">split</span>(pp1))</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-144-1.png" width="672" /></p>
<p>These two patterns look quite different. And yet, when we count the events by quadrats:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">quadratcount</span>(<span class="kw">split</span>(pp1), <span class="dt">nx =</span> <span class="dv">3</span>, <span class="dt">ny =</span> <span class="dv">3</span>))</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-145-1.png" width="672" /></p>
<p>This example highlights how quadrats are relatively coarse measures of density, and fail to distinguish between fairly different event distributions, in particular because quadrat analysis does not take into account the relative position of the events with respect to each other.</p>
</div>
<div id="kernel-density" class="section level2">
<h2><span class="header-section-number">10.8</span> Kernel density</h2>
<p>In order to better take into account the relative position of the events with respect to each other, a different technique can be devised.</p>
<p>Imagine that a quadrat is a kind of “window”. We use it to observe the landscape. When we count the number of events in a quadrat, we simply peek through that particular window: all events inside the “window” are simply counted, and all events outside the “window” are ignored. Then we visit another quadrat and do the same, until we have visited all quadrats.</p>
<p>Imagine now that we define a window that, unlike the quadrats which are fixed, can move and visit different points in space. This window also has the property that, instead of counting the events that are in the window, it gives greater weight to events that are close to the center of the window, and less weight to events that are more distant from the center of the window.</p>
<p>We can define such a window by selecting a function that declines with increasing distance. We will call this function a <em>kernel</em>. An example of a function that can work as a moving window is the following.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(<span class="dt">dist =</span> <span class="kw">c</span>(-<span class="dv">3</span>, <span class="dv">3</span>)), <span class="kw">aes</span>(dist)) +
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm, <span class="dt">n =</span> <span class="dv">101</span>, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)) +
<span class="st">  </span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.75</span>))</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-146-1.png" width="672" /></p>
<p>As you can see, the value of the function declines with increasing distance from the center of the window (when dist == 0; note that the value never becomes zero!). This is a <em>Gaussian kernel</em>. The shape of the Gaussian kernel depends on a variance parameter, which we will call the <em>kernel bandwidth</em>.</p>
<p>The bandwidth controls how rapidly the weight assigned to distant events decays. Change the value of the argument <code>sd</code> in the chunk above. You will see that as it becomes smaller, the slope of the kernel becomes steeper (and distant observations are downweighted rapidly). On the contrary, as it becomes larger, the slope becomes less steep (and distant events are weighted almost as highly as close events).</p>
<p>Kernel density estimates are usually obtained by creating a fine grid that is superimposed on the region. The kernel function then visits each point on the grid and obtains an estimate of the density by summing the weights of all events as per the kernel function.</p>
<p>Kernel density is implemented in <code>spatstat</code> and can be used as follows.</p>
<p>The input is a <code>ppp</code> object, and optionally a <code>sigma</code> argument that corresponds to the bandwidth of the kernel:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">kernel_density &lt;-<span class="st"> </span><span class="kw">density</span>(<span class="kw">split</span>(pp1), <span class="dt">sigma =</span> <span class="fl">0.1</span>)
<span class="kw">plot</span>(<span class="kw">split</span>(pp1))</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-147-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(kernel_density)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-147-2.png" width="672" /></p>
<p>The plots above illustrate how the map of the kernel density is better able to capture the variations in density across the region. In fact, kernel density is a smooth estimate of the underlying intensity of the process, and the degree of smoothing is controlled by the bandwidth.</p>
<p>This concludes Practice 5.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="point-pattern-analysis-i-activity.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="point-pattern-analysis-ii-activity.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
